<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="user.css">
        <title>Polling for Newsletter District 11</title>
        
        <script type="module">
            // Code To Integrate Firebase As Backend (Saves Questions Into Database)

            import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
            import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
          
            const firebaseConfig = {
                apiKey: "AIzaSyCS9TpVUkQpDpXHVpfC8VXparXSG30T_Ww",
                authDomain: "polling-platform-district-11.firebaseapp.com",
                projectId: "polling-platform-district-11",
                storageBucket: "polling-platform-district-11.firebasestorage.app",
                messagingSenderId: "20414616265",
                appId: "1:20414616265:web:20cb7202449e356c233318"
            };

            const app = initializeApp(firebaseConfig);
            const db = getFirestore(app);

            window.db = db;
            window.firestoreFns = { getDocs, collection };
        </script>

    </head>
    <body>
        <!--Add main header and newsletter placeholder here-->

        <h1 id="header">Polling Over District 11 Issues</h1>
        <p>Let your local representative know how you feel regarding these important issues and allow her to make more informed decisions.</p>
        <br>

        <div id="pollContainer"></div>

        
        <script type="module">
            const {db: firestoreDB, firestoreFns } = window;
            const { getDocs, collection } = firestoreFns;
            const pollContainer = document.getElementById('pollContainer');
            const querySnapshot = await getDocs(collection(db, 'polls'))

            querySnapshot.forEach((doc) => {
                const data = doc.data()
                const question = data.question;
                const options = data.options;

                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-block';

                const questionText = document.createElement('h3');
                questionText.textContent = question;
                questionDiv.appendChild(questionText);

                options.forEach(option => {
                    const label = document.createElement('label');
                    const radio = document.createElement('input');
                    radio.type = 'radio';
                    radio.name = question;
                    radio.value = option;

                    label.appendChild(radio);
                    label.append(` ${option}`);
                    questionDiv.appendChild(label);
                    questionDiv.appendChild(document.createElement('br'));
                });
                   
                pollContainer.appendChild(questionDiv);
                    
            });
        </script>

    </body>
</html>